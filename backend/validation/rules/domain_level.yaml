# Domain-level validation rules (SEND-VAL-001 through SEND-VAL-006)
# These rules operate within a single domain and check structure, format, and timing.

rules:
  - id: "SEND-VAL-001"
    core_ref: null
    name: "Required variables present"
    description: "Checks that all required SEND variables are present in each domain dataset. Required variables are defined per domain by the SENDIG specification."
    severity: "Error"
    category: "Required variables"
    applicable_domains: ["ALL"]
    check_type: "required_variables"
    parameters: {}
    fix_guidance: "Add missing variables to dataset"
    auto_fixable: false
    default_fix_tier: 3
    evidence_type: "missing-value"
    cdisc_reference: "SENDIG 3.1, Section 4-6"

  - id: "SEND-VAL-002"
    core_ref: null
    name: "Variable naming conventions"
    description: "Validates that variable names conform to SEND naming conventions, including maximum length and allowed character restrictions."
    severity: "Warning"
    category: "Variable format"
    applicable_domains: ["ALL"]
    check_type: "variable_format"
    parameters:
      max_length: 8
    fix_guidance: "Rename variables to follow SEND naming conventions"
    auto_fixable: false
    default_fix_tier: 2
    evidence_type: "value-correction"
    cdisc_reference: "SENDIG 3.1, Section 2.1"

  - id: "SEND-VAL-003"
    core_ref: null
    name: "Data type validation"
    description: "Checks that numeric columns contain only valid numeric values. Detects non-numeric strings in columns defined as Num type by the SENDIG specification."
    severity: "Error"
    category: "Data integrity"
    applicable_domains: ["ALL"]
    check_type: "data_type_check"
    parameters: {}
    fix_guidance: "Convert non-numeric values or set to null"
    auto_fixable: false
    default_fix_tier: 2
    evidence_type: "value-correction"
    cdisc_reference: "SENDIG 3.1, Section 2.2"

  - id: "SEND-VAL-004"
    core_ref: null
    name: "Controlled terminology validation"
    description: "Validates that variable values match CDISC controlled terminology where applicable. Checks coded values against the published CT lists for the SEND standard."
    severity: "Warning"
    category: "Controlled terminology"
    applicable_domains: ["ALL"]
    check_type: "controlled_terminology"
    parameters: {}
    fix_guidance: "Map values to CDISC controlled terminology"
    auto_fixable: true
    default_fix_tier: 2
    evidence_type: "value-correction"
    cdisc_reference: "SENDIG 3.1, Section 2.3"

  - id: "SEND-VAL-005"
    core_ref: null
    name: "Date/time format validation"
    description: "Checks that all date and datetime variables conform to ISO 8601 format (YYYY-MM-DD or YYYY-MM-DDThh:mm:ss). Detects non-standard date formats and partial dates that do not follow ISO conventions."
    severity: "Error"
    category: "Timing"
    applicable_domains: ["ALL"]
    check_type: "date_format"
    parameters: {}
    fix_guidance: "Convert dates to ISO 8601 format (YYYY-MM-DD)"
    auto_fixable: true
    default_fix_tier: 2
    evidence_type: "value-correction"
    cdisc_reference: "SENDIG 3.1, Section 2.4"

  - id: "SEND-VAL-006"
    core_ref: null
    name: "Study day consistency"
    description: "Validates that study day variables (--DY) are consistent with the corresponding date variables (--DTC) relative to the reference start date (RFSTDTC) from the DM domain. Flags records where calculated study day differs from reported study day beyond the allowed tolerance."
    severity: "Warning"
    category: "Timing"
    applicable_domains: ["ALL"]
    check_type: "study_day_check"
    parameters:
      tolerance: 1
    fix_guidance: "Recalculate study days from DTC and RFSTDTC"
    auto_fixable: false
    default_fix_tier: 2
    evidence_type: "range-check"
    cdisc_reference: "SENDIG 3.1, Section 2.5"
